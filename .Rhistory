library(readxl)
library(rstudioapi)
library(lsrm12pl)
library("SNFtool")
library(flexclust)
library("fpc")
library("ggplot2")
# library(factoextra)
library(RColorBrewer)
library(dbscan)
library(readxl)
library(readr)
library(Rcpp)
library(MCMCpack)
library(dplyr)
library(ggrepel)
setwd("C:/Users/Song1/PycharmProjects/COVID")
getwd()
sourceCpp("lsrm1pl_normal_missing.cpp")
#dir = "/Users/yeseul/Dropbox/Kelly/???븰?썝/吏꾩씡?썕援먯닔?떂/gViz/90_result"
#dir = "/Users/jeon-yeseul/Dropbox/Kelly/???븰?썝/吏꾩씡?썕援먯닔?떂/gViz/75_result"
data=read.csv("data_prob_90.csv",fileEncoding = guess_encoding("./data_prob_90.csv")[1,1] %>% as.character)
head(data)
data
data_word = data[,1]
data=data[,-1]
data[is.na(data)] = 99
data_m = as.matrix(data)
logit.x = log(data_m /(1-data_m ))
head(logit.x)
### covid_20
ndim     = 2
niter    = 55000
nburn    = 5000
nthin    = 5
nprint   = 5000
jump_beta     = 0.3
jump_theta    = 1.0
jump_w        = 0.06
jump_z        = 0.5
jump_gamma    = 0.01
pr_mean_beta  = 0
pr_sd_beta    = 1
pr_mean_theta = 0
pr_sd_theta   = 1
pr_mean_gamma = 0.0
pr_sd_gamma = 1.0
pr_a_sigma = 0.001
pr_b_sigma = 0.001
pr_a_th_sigma = 0.001
pr_b_th_sigma = 0.001
#Set 99 as missing
'''
output = onepl_lsrm_cont_missing(as.matrix(data),
ndim, niter, nburn, nthin, nprint,
jump_beta, jump_theta,  jump_gamma, jump_z, jump_w,
pr_mean_beta, pr_sd_beta, pr_a_th_sigma, pr_b_th_sigma, pr_mean_theta,
pr_a_sigma, pr_b_sigma,pr_mean_gamma, pr_sd_gamma, 99)
'''
output = onepl_lsrm_cont_missing(as.matrix(logit.x),
ndim, niter, nburn, nthin, nprint,
jump_beta, jump_theta,  jump_gamma, jump_z, jump_w,
pr_mean_beta, pr_sd_beta, pr_a_th_sigma, pr_b_th_sigma, pr_mean_theta,
pr_a_sigma, pr_b_sigma,pr_mean_gamma, pr_sd_gamma, 99)
